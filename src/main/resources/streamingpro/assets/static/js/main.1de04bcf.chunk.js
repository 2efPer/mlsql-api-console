(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{238:function(e,t,a){},349:function(e,t,a){e.exports=a(734)},354:function(e,t,a){},358:function(e,t,a){},360:function(e,t,a){},362:function(e,t,a){},374:function(e,t,a){},455:function(e,t,a){},728:function(e,t,a){},734:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(10),l=a.n(o);a(354),a(358),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var i=a(11),c=a(13),s=a(15),u=a(12),m=a(14),d=a(9),p=(a(360),a(290)),h=a(72),f=a(293),g=a(742),b=a(236),E=a(237),v=(a(362),{GET:"get",POST:"post",PUT:"put"}),y={Success:200,BadRequest:400,Unauthorized:401,Forbidden:404,ServerError:500},S={name:"access-token"},O=a(199),w=function e(t){Object(i.a)(this,e),this.value=t},j=function e(t,a,n){var r=this;Object(i.a)(this,e),this.json=function(e,t){r.content.then(function(a){try{var n=JSON.parse(a);e(n)}catch(r){t(a)}})},this.status=t,this.content=a,this.accessToken=n},k=function(){function e(t){Object(i.a)(this,e),this.url=t}return Object(c.a)(e,[{key:"request2",value:function(e,t,a){this.request(v.POST,e,function(e){e.json(function(e){t(e)},function(e){a(e)})},function(e){try{e.value().content(function(e){a(e)})}catch(t){a(e?e.toString():"result is null")}})}},{key:"runScript",value:function(e,t,a,n){var r=new V,o=O(),l=this;r.user(function(r){var i=r.userName,c=r.backendTags;if(c){var s={sql:t,owner:i,jobName:o,sessionPerUser:!0,show_stack:!0,tags:c||""};Object.assign(s,e),(e.background||!1)&&Object.assign(s,{async:!0,callback:""}),l.request(v.POST,s,function(e){if(200===e.status)e.json(function(e){a(e)},function(e){n(e)});else try{e.content.then(function(e){n(e)})}catch(t){n("backend status:"+e.status)}},function(e){try{e.value().content(function(e){n(e)})}catch(t){n(e?e.toString():"result is null")}})}else n("\n                \n                ---------------Warning--------------------\n                \n                Please make sure you have backend configured. \n                If not, please contact admin;\n                \n                ------------------------------------------\n                ")})}},{key:"request",value:function(e,t,a,n){e=e.toUpperCase();var r=[];for(var o in t){var l=encodeURIComponent(o),i=encodeURIComponent(t[o]);r.push(l+"="+i)}var c=this.url;return"GET"===e?(c=c+"?"+r,r=void 0):r=r.join("&"),fetch(c,{method:e,timeout:864e5,headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json","Access-Token":sessionStorage.getItem(S.name)||""},body:r}).then(function(e){a(new j(e.status,e.text(),e.headers.get(S.name)))}).catch(function(e){n(new w(e))})}}]),e}(),C="/api_v1/user/tags/update",T="/api_v1/users",D="/api_v1/script_file",x="/api_v1/script_file/remove",N="/api_v1/script_file/get",R="/api_v1/run/script",L="/api_v1/cluster",P="/api_v1/file/upload",M=a(309),V=function(){function e(){Object(i.a)(this,e)}return Object(c.a)(e,[{key:"isLogin",value:function(){return null!==sessionStorage.getItem(S.name)}},{key:"userName",value:function(e){new k("/api_v1/user/userName").request(v.GET,{},function(t){t.status===y.Unauthorized?sessionStorage.removeItem(S.name):t.content.then(function(t){e(JSON.parse(t).userName)}).catch(function(e){})},function(e){console.log(e)})}},{key:"user",value:function(e){new k("/api_v1/user/userName").request2({},function(t){e(t)},function(e){})}},{key:"login",value:function(e,t,a,n){this.registerOrLogin("/api_v1/user/login",e,t,a,n)}},{key:"logout",value:function(){sessionStorage.removeItem(S.name)}},{key:"register",value:function(e,t,a,n){this.registerOrLogin("/api_v1/user/register",e,t,a,n)}},{key:"registerOrLogin",value:function(e,t,a,n,r){var o={userName:t,password:a};new k(e).request(v.POST,o,function(e){e.accessToken&&(sessionStorage.setItem(S.name,e.accessToken),(new M.a).set(S.name,e.accessToken,{path:"/"}));n(e)},function(e){r(e)})}}]),e}(),A=(a(105),a(201),a(59)),B=a.n(A),I=(a(373),a(205),a(206),a(374),a(207),a(292)),F=a(745),q=function(e,t){if(!e){if(t=t||"Assertion failed","undefined"!==typeof Error)throw new Error(t);throw t}},_=a(744),U=a(735),Q=a(296),H=a(297),G=a(749),z=a(144),J=a.n(z),W=a(746),K=a(291),$=W.a.Group,Y=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).etPopLoad=e.parent,a.state={},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return n.createElement("div",null,n.createElement("span",null,"parameters:"),n.createElement($,{compact:!0},this.state.dataForRender))}}]),t}(n.Component),Z=W.a.Group,X=K.a.Option,ee=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).sourceType=function(e,t){a.data.sourceTypeV=e;var r=Object(d.a)(Object(d.a)(a));new k(R).runScript({},"load _mlsql_.`datasources/params/".concat(e,"` as output;"),function(e){var t=[];e.forEach(function(e){t.push(n.createElement(Q.a,null,n.createElement(H.a,null,n.createElement(W.a,{style:{marginBottom:"10px"},name:e.param,onChange:a.params,type:"text",addonBefore:e.param,placeholder:e.description}))))}),r.loadParamsRef.current.setState({dataForRender:t})},function(e){})},a.path=function(e){a.data.pathV=e.target.value},a.tableName=function(e){a.data.tableNameV=e.target.value},a.makeMLSQL=function(){var e=Object(d.a)(Object(d.a)(a));return"load ".concat(e.data.sourceTypeV,".`").concat(e.data.pathV,'` where key="value" as ').concat(e.data.tableNameV,";")},a.etpop=e.parent,a.data={},a.state={datasourcesRender:[]},a.loadParamsRef=n.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;new k(R).runScript({},"load _mlsql_.`datasources` as output;",function(t){var a=[];t.forEach(function(e){a.push(n.createElement(X,{key:e.name,value:e.name},e.name))}),e.setState({datasourcesRender:a})},function(e){})}},{key:"render",value:function(){return n.createElement("div",null,n.createElement(Z,{compact:!0},n.createElement(Q.a,null,n.createElement(H.a,null,"soureType:",n.createElement(K.a,{onChange:this.sourceType,showSearch:!0,style:{width:200},placeholder:"Choose DataSource type",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.datasourcesRender)))),n.createElement("br",null),n.createElement(Z,{compact:!0},n.createElement(Q.a,null,n.createElement(H.a,null,n.createElement(W.a,{onChange:this.path,type:"text",label:"Path",addonBefore:"Path",placeholder:"File path or tableName"})))),n.createElement("br",null),n.createElement(Z,{compact:!0},n.createElement(Q.a,null,n.createElement(H.a,null,n.createElement(W.a,{type:"text",onChange:this.tableName,label:"tableName",addonBefore:"tableName",placeholder:"tableName"})))),n.createElement("br",null),n.createElement(Y,{parent:this,ref:this.loadParamsRef}))}}]),t}(n.Component),te=W.a.Group,ae=(K.a.Option,W.a.TextArea),ne=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).renderParam=function(e){return"keepVersion"===e.param&&"evaluateTable"===e.param?null:"code"===e.param||"fitParam.[group].code"===e.param?n.createElement(Q.a,null,n.createElement(H.a,null,e.param,":",n.createElement(ae,{style:{marginBottom:"10px"},name:e.param,onChange:a.params,type:"text",rows:10}))):n.createElement(Q.a,null,n.createElement(H.a,null,n.createElement(W.a,{style:{marginBottom:"10px"},name:e.param,onChange:a.params,type:"text",addonBefore:e.param,placeholder:e.description})))},a.params=function(e){a.data.params[e.target.getAttribute("name")]=e.target.value},a.path=function(e){a.data.pathV=e.target.value},a.tableName=function(e){a.data.tableNameV=e.target.value},a.makeMLSQL=function(){Object(d.a)(Object(d.a)(a));var e=[];for(var t in a.data.params){var n=a.data.params[t];e.push(t.replace(/\[group\]/g,"0")+'="'+n+'"')}return 0==e.length&&e.push('keepVersion="true"'),"train ".concat(a.data.tableNameV," as ").concat(a.name,".`").concat(a.data.pathV,"` where \n").concat(e.join(" and\n "),";")},a.etpop=e.parent,a.name=e.name,a.data={params:{}},a.state={dataForRender:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this;new k(R).runScript({},"load modelParams.`".concat(t.name,"` as output;"),function(a){var r=[];a.forEach(function(t){var a=e.renderParam(t);null!==a&&(r.push(a),r.push(n.createElement("br",null)))}),t.setState({dataForRender:r})},function(e){})}},{key:"render",value:function(){return n.createElement("div",null,n.createElement("span",null,"Training data and model path:"),n.createElement(te,{compact:!0},n.createElement(Q.a,null,n.createElement(H.a,null,n.createElement(W.a,{type:"text",onChange:this.tableName,size:"large",addonBefore:"tableName",placeholder:"the table of training data"})))),n.createElement("br",null),n.createElement(te,{compact:!0},n.createElement(Q.a,null,n.createElement(H.a,null,n.createElement(W.a,{onChange:this.path,type:"text",size:"large",addonBefore:"Model save path",placeholder:"the location you save you model"})))),n.createElement("br",null),n.createElement("span",null,"Algorithm parameters:"),n.createElement(te,{compact:!0},this.state.dataForRender))}}]),t}(n.Component),re=W.a.Group,oe=K.a.Option,le=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).sourceType=function(e,t){a.data.sourceTypeV=e},a.saveMode=function(e,t){a.data.saveModeV=e},a.path=function(e){a.data.pathV=e.target.value},a.tableName=function(e){a.data.tableNameV=e.target.value},a.partitionBy=function(e){a.data.partitionByV=e.target.value},a.fileNum=function(e){a.data.fileNumV=e.target.value},a.makeMLSQL=function(){var e=Object(d.a)(Object(d.a)(a)),t="";a.data.partitionByV&&(t="partitionBy "+a.data.partitionByV);var n='key="value"';return a.data.fileNumV&&(n='fileNum="'.concat(a.data.fileNumV,'"')),"save ".concat(e.data.saveModeV," ").concat(e.data.tableNameV," as ").concat(e.data.sourceTypeV,".`").concat(e.data.pathV,"` \n where ").concat(n," ").concat(t,";")},a.etpop=e.parent,a.data={},a.state={datasourcesRender:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;new k(R).runScript({},"load _mlsql_.`datasources` as output;",function(t){var a=[];t.forEach(function(e){a.push(n.createElement(oe,{key:e.name,value:e.name},e.name))}),e.setState({datasourcesRender:a})},function(e){})}},{key:"render",value:function(){return n.createElement("div",null,n.createElement(re,{compact:!0},n.createElement(Q.a,null,n.createElement(H.a,null,"soureType:",n.createElement(K.a,{onChange:this.sourceType,showSearch:!0,style:{width:200},placeholder:"Choose DataSource type",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.datasourcesRender)))),n.createElement("br",null),n.createElement(re,{compact:!0},n.createElement(Q.a,null,n.createElement(H.a,null,"SaveMode:",n.createElement(K.a,{onChange:this.saveMode,showSearch:!0,style:{width:200},placeholder:"Choose save mode type",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},n.createElement(oe,{key:"overwrite",value:"overwrite"},"overwrite"),n.createElement(oe,{key:"append",value:"append"},"append"),n.createElement(oe,{key:"errorIfExists",value:"errorIfExists"},"errorIfExists"),n.createElement(oe,{key:"ignore",value:"ignore"},"ignore"))))),n.createElement("br",null),n.createElement(re,{compact:!0},n.createElement(Q.a,null,n.createElement(H.a,null,n.createElement(W.a,{type:"text",onChange:this.tableName,label:"tableName",addonBefore:"tableName",placeholder:"the tableName will be saved"})))),n.createElement("br",null),n.createElement(re,{compact:!0},n.createElement(Q.a,null,n.createElement(H.a,null,n.createElement(W.a,{onChange:this.path,type:"text",addonBefore:"Target Path",placeholder:"File path or tableName"})))),n.createElement("br",null),n.createElement(re,{compact:!0},n.createElement(Q.a,null,n.createElement(H.a,null,n.createElement(W.a,{type:"text",onChange:this.partitionBy,addonBefore:"partitionBy",placeholder:"partitionBy"})))),n.createElement("br",null),n.createElement(re,{compact:!0},n.createElement(Q.a,null,n.createElement(H.a,null,n.createElement(W.a,{type:"text",onChange:this.fileNum,addonBefore:"fileNum",placeholder:"fileNum"})))),n.createElement("br",null))}}]),t}(n.Component),ie=a(80),ce=W.a.Group,se=(K.a.Option,W.a.TextArea),ue=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).renderParam=function(e){return"keepVersion"===e.param||"evaluateTable"===e.param?null:"code"===e.param||"fitParam.[group].code"===e.param?n.createElement(Q.a,null,n.createElement(H.a,null,e.param,":",n.createElement(se,{style:{marginBottom:"10px"},name:e.param,onChange:a.params,type:"text",rows:10}))):n.createElement(Q.a,{key:e.param},n.createElement(H.a,null,n.createElement(W.a,{style:{marginBottom:"10px"},name:e.param,onChange:a.params,type:"text",addonBefore:e.param,placeholder:e.description})))},a.params=function(e){a.data.params[e.target.getAttribute("name")]=e.target.value},a.path=function(e){a.data.pathV=e.target.value},a.tableName=function(e){a.data.tableNameV=e.target.value},a.outputTableName=function(e){a.data.outputTableNameV=e.target.value},a.showTableName=function(){return"true"!==a.state.tableHidden?n.createElement(ce,{compact:!0},n.createElement(Q.a,null,n.createElement(H.a,null,n.createElement(W.a,{type:"text",onChange:a.tableName,size:"large",addonBefore:a.state.tableAlias?a.state.tableAlias:"Input table",placeholder:""})))):null},a.showOutputTableName=function(){return"true"!==a.state.outputTableHidden?n.createElement(ce,{compact:!0},n.createElement(Q.a,null,n.createElement(H.a,null,n.createElement(W.a,{type:"text",onChange:a.outputTableName,size:"large",addonBefore:a.state.outputTableAlias?a.state.outputTableAlias:"Output table",placeholder:""})))):null},a.pathNameForRender=function(){return a.state.pathAlias?a.state.pathAlias:"Save path"},a.showPathName=function(){return"true"!==a.state.pathHidden?n.createElement(ce,{compact:!0},n.createElement(Q.a,null,n.createElement(H.a,null,n.createElement(W.a,{onChange:a.path,type:"text",size:"large",addonBefore:a.pathNameForRender(),placeholder:""})))):""},a.etpop=e.parent,a.name=e.name,a.data={params:{}},a.state={dataForRender:[],tableHidden:e.tableHidden,pathAlias:e.pathAlias,pathHidden:e.pathHidden,outputTableHidden:e.outputTableHidden,outputTableAlias:e.outputTableAlias,tableAlias:e.tableAlias},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this;new k(R).runScript({},"load modelParams.`".concat(t.name,"` as output;"),function(a){var r=[];a.forEach(function(t){var a=e.renderParam(t);null!==a&&(r.push(a),r.push(n.createElement("br",null)))}),t.setState({dataForRender:r})},function(e){})}},{key:"_makeMLSQL",value:function(){var e=[];for(var t in this.data.params){var a=this.data.params[t],n='"'+a+'"';"code"!==t&&"fitParam.[group].code"!==t||(n="'''"+a+"'''"),e.push(t.replace(/\[group\]/g,"0")+"="+n)}var r="";e.length>0&&(r="where");var o="";return this.data.outputTableNameV&&(o="as ".concat(this.data.outputTableNameV)),"run ".concat(this.data.tableNameV||"command"," as ").concat(this.name,".`").concat(this.data.pathV||"","` ").concat(r," ").concat(e.join("and\n ")," ").concat(o,";")}},{key:"_render",value:function(){return n.createElement("div",null,this.showTableName(),n.createElement("br",null),this.showOutputTableName(),n.createElement("br",null),this.showPathName(),n.createElement("br",null),0==this.state.dataForRender.length?"":n.createElement("span",null,"Parameters:"),n.createElement(ce,{compact:!0},this.state.dataForRender))}}]),t}(n.Component),me=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).makeMLSQL=function(){return Object(ie.a)(Object(u.a)(t.prototype),"_makeMLSQL",Object(d.a)(a)).call(Object(d.a)(a))},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return Object(ie.a)(Object(u.a)(t.prototype),"_render",this).call(this)}}]),t}(ue),de=W.a.Group,pe=(K.a.Option,function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).makeMLSQL=function(){Object(d.a)(Object(d.a)(a));var e=[];for(var t in a.data.params){var n=a.data.params[t];e.push(t.replace(/\[group\]/g,"0")+'="'+n+'"')}return 0==e.length&&e.push('keepVersion="true"'),"run command as ".concat(a.name,".`` where \n").concat(e.join(" and\n "),";")},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return n.createElement("div",null,n.createElement(de,{compact:!0},this.state.dataForRender))}}]),t}(me)),he=(a(431),a(432),a(433),a(298)),fe=a.n(he),ge=K.a.Option,be=W.a.TextArea,Ee=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).udfName=function(e){a.data.udfNameV=e.target.value},a.dataType=function(e){a.data.dataTypeV=e.target.value},a.udfType=function(e){a.udfTypeV=e},a.code=function(e){a.codeV=e},a.langSelect=function(e){a.lang=e,a.codeCheckRef.current.checked=!1,a.setState({dataType:!1}),"python"===a.lang&&a.setState({dataType:!0}),a.setState({codeLang:e})},a.setCodeExample=function(e){e?a.codeRef.current.editor.setValue(a.codeExample()):a.codeRef.current.editor.setValue("")},a.codeExample=function(){var e=a.state.codeLang||"scala";return"scala"===e?"def apply(a:Double,b:Double)={\n   a + b\n}":"python"===e?"def apply(self,m):\n    return m":"java"===e?"import java.util.HashMap;\nimport java.util.Map;\npublic class UDF {\n  public Map<String, Integer[]> apply(String s) {\n    Map<String, Integer[]> m = new HashMap<>();\n    Integer[] arr = {1};\n    m.put(s, arr);\n    return m;\n  }\n}":null},a.showDataType=function(){return a.state.dataType?n.createElement(Q.a,null,n.createElement(H.a,null,"dataType:",n.createElement(be,{style:{marginBottom:"10px"},name:"dataType",rows:10,onChange:a.dataType,type:"text",addonBefore:"dataType",placeholder:"This is not required when lang is scala\nAs we know python is not strongly typed language, so\nwe should manually spcify the return type.\nmap(string,string) means a map with key is string type,value also is string type.\narray(string) means a array with string type element.\nnested is support e.g. array(array(map(string,array(string))))\n\n"}))):null},a.showCode=function(){return n.createElement("div",null,n.createElement(Q.a,null,n.createElement(H.a,null,"code:",n.createElement(B.a,{ref:a.codeRef,mode:a.state.codeLang||"scala",theme:"github",width:"400px",height:"300px",name:"code",fontSize:16,showPrintMargin:!0,showGutter:!0,highlightActiveLine:!0,onChange:a.code,editorProps:{$blockScrolling:1/0},setOptions:{enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,enableSnippets:!1,showLineNumbers:!0,tabSize:2}}))),n.createElement(Q.a,null,n.createElement(H.a,null,n.createElement(H.a,{span:8},"Show CodeExample:",n.createElement(fe.a,{ref:a.codeCheckRef,onChange:a.setCodeExample})))))},a.makeMLSQL=function(){Object(d.a)(Object(d.a)(a));var e=[];return e.push('lang="'.concat(a.lang,'"')),e.push("code='''".concat(a.codeV,"'''")),e.push('udfType="'.concat(a.udfTypeV,'"')),a.dataTypeV&&e.push("dataType='''".concat(a.dataTypeV,"'''")),"register ScriptUDF.`` as ".concat(a.data.udfNameV," where \n").concat(e.join("\nand "),";")},a.etpop=e.parent,a.name=e.name,a.data={params:{}},a.state={dataForRender:[]},a.codeRef=n.createRef(),a.codeCheckRef=n.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return n.createElement("div",null,n.createElement(Q.a,null,n.createElement(H.a,null,n.createElement(W.a,{onChange:this.udfName,type:"text",size:"large",addonBefore:"UDF Name",placeholder:"the name of udf"}))),n.createElement("br",null),n.createElement(Q.a,null,n.createElement(H.a,{span:4},n.createElement("span",null,"udfType:")),n.createElement(H.a,{span:20},n.createElement(K.a,{showSearch:!0,onChange:this.udfType,style:{width:200},placeholder:"Select udf type",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},n.createElement(ge,{value:"udf"},"udf"),n.createElement(ge,{value:"udaf"},"udaf")))),n.createElement("br",null),n.createElement(Q.a,null,n.createElement(H.a,{span:4},n.createElement("span",null,"Lang:")),n.createElement(H.a,{span:20},n.createElement(K.a,{showSearch:!0,style:{width:200},placeholder:"Select language type",optionFilterProp:"children",onChange:this.langSelect,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},n.createElement(ge,{value:"java"},"java"),n.createElement(ge,{value:"scala"},"scala"),n.createElement(ge,{value:"python"},"python")))),n.createElement("br",null),this.showDataType(),n.createElement("br",null),this.showCode(),n.createElement("br",null),n.createElement(Q.a,null,n.createElement(H.a,null,n.createElement(W.a,{style:{marginBottom:"10px"},name:"methodName",onChange:this.params,type:"text",addonBefore:"methodName",placeholder:"methodName"}))))}}]),t}(n.Component),ve=(W.a.Group,K.a.Option),ye=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).etName=function(e){a.etName=e},a.makeMLSQL=function(){return"load modelExample.`".concat(a.etName,"` as output;")},a.etpop=e.parent,a.name=e.name,a.data={params:{}},a.state={dataForRender:[],tableHidden:e.tableHidden,pathAlias:e.pathAlias,pathHidden:e.pathHidden},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;new k(R).runScript({},"load model.`list` as output;",function(t){var a=[];t.forEach(function(e){a.push(n.createElement(ve,{key:e.name,value:e.name},e.name))}),e.setState({dataForRender:a})},function(e){})}},{key:"render",value:function(){return n.createElement("div",null,n.createElement(Q.a,null,n.createElement(H.a,null,"ET:",n.createElement(K.a,{onChange:this.etName,showSearch:!0,style:{width:200},placeholder:"Choose DataSource type",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.dataForRender))))}}]),t}(n.Component),Se=(W.a.Group,K.a.Option),Oe=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).makeMLSQL=function(){var e=Object(d.a)(Object(d.a)(a));return"register ".concat(e.data.sourceTypeV,".`").concat(e.data.pathV,"` as ").concat(e.data.outputTableNameV,";")},a.etName=function(e){a.data.sourceTypeV=e},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;new k(R).runScript({},"load model.`list` as output;",function(t){var a=[];t.forEach(function(e){a.push(n.createElement(Se,{key:e.name,value:e.name},e.name))}),e.setState({dataForRender:a})},function(e){})}},{key:"render",value:function(){return n.createElement("div",null,this.showTableName(),n.createElement("br",null),this.showOutputTableName(),n.createElement("br",null),this.showPathName(),n.createElement("br",null),n.createElement(Q.a,null,n.createElement(H.a,null,"ET:",n.createElement(K.a,{onChange:this.etName,showSearch:!0,style:{width:200},placeholder:"Choose DataSource type",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.dataForRender))))}}]),t}(me),we=W.a.Group,je=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).makeMLSQL=function(){var e="";a.data.outputTableNameV&&(e="as ".concat(a.data.outputTableNameV));var n=Object(ie.a)(Object(u.a)(t.prototype),"_makeMLSQL",Object(d.a)(a)).call(Object(d.a)(a)).replace(e,""),r="predict ".concat(a.data.tableNameV," as ").concat(a.name,".`").concat(a.data.pathV||"","` ").concat(e,";");return"".concat(n,"\n        ").concat(r,"\n        register ").concat(a.name,".`").concat(a.data.pathV||"","` as ").concat(a.data.functionNameV,"; \n        ").stripMargin()},a.functionName=function(e){a.data.functionNameV=e.target.value},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return n.createElement("div",null,this.showTableName(),n.createElement("br",null),this.showOutputTableName(),n.createElement("br",null),this.showPathName(),n.createElement("br",null),n.createElement(we,{compact:!0},n.createElement(Q.a,null,n.createElement(H.a,null,n.createElement(W.a,{onChange:this.functionName,type:"text",size:"large",addonBefore:"functionName",placeholder:"A function you can use to convert String to number or number to String"})))),n.createElement("br",null),0==this.state.dataForRender.length?"":n.createElement("span",null,"Parameters:"),n.createElement(we,{compact:!0},this.state.dataForRender))}}]),t}(ue),ke=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).makeMLSQL=function(){var e="/api_v1/public/file/download?fileName=".concat(encodeURIComponent(a.data.pathV)),t=document.createElement("a");return t.href=e,t.target="_blank",document.body.appendChild(t),t.click(),document.body.removeChild(t),""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return Object(ie.a)(Object(u.a)(t.prototype),"_render",this).call(this)}}]),t}(ue),Ce=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).disableEtModalVisible=function(){a.et.setState({etPop:!1,etModalVisible:!1})},a.enableEtModalVisible=function(){var e=a.popChild.current.makeMLSQL();a.et.makeMLSQL(e),a.et.setState({etPop:!1,etModalVisible:!1})},a.renderContent=function(){return"load"===a.et.state.eventName?n.createElement(ee,{parent:Object(d.a)(Object(d.a)(a)),ref:a.popChild}):"save"===a.et.state.eventName?n.createElement(le,{name:a.et.state.eventName,ref:a.popChild}):"DownloadExt"===a.et.state.eventName?n.createElement(pe,{name:a.et.state.eventName,ref:a.popChild}):"StringIndex"===a.et.state.eventName?n.createElement(je,{name:a.et.state.eventName,ref:a.popChild}):"DownloadFile"===a.et.state.eventName?n.createElement(ke,Object.assign({name:a.et.state.eventName,ref:a.popChild},a.et.state)):"ETExample"===a.et.state.eventName?n.createElement(ye,{name:a.et.state.eventName,ref:a.popChild}):"ScriptUDF"===a.et.state.eventName?n.createElement(Ee,{name:a.et.state.eventName,ref:a.popChild}):"register"===a.et.state.eventName?n.createElement(Oe,Object.assign({name:a.et.state.eventName,ref:a.popChild},a.et.state)):"tool"===a.et.state.processType?n.createElement(me,Object.assign({name:a.et.state.eventName,ref:a.popChild},a.et.state)):n.createElement(ne,{name:a.et.state.eventName,ref:a.popChild})},a.et=e.parent,a.popChild=n.createRef(),a.state={etModalVisible:!0,title:e.title},a.data={},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return n.createElement("div",null,n.createElement(J.a,{title:this.state.title,visible:this.state.etModalVisible,onCancel:this.disableEtModalVisible,onOk:this.enableEtModalVisible,okText:"Ok",cancelText:"Cancel"},this.renderContent()))}}]),t}(n.Component),Te=a(26),De=a.n(Te),xe=_.a.Panel,Ne=(U.a.TabPane,function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).onDragStart=function(e){var t=e.target.getAttribute("processtype");e.dataTransfer.setData("eventName",e.target.getAttribute("name")),e.dataTransfer.setData("popName",e.target.getAttribute("help")),e.dataTransfer.setData("processType",t),e.dataTransfer.setData("pathAlias",e.target.getAttribute("pathalias")||""),e.dataTransfer.setData("outputTableAlias",e.target.getAttribute("outputtablealias")||""),e.dataTransfer.setData("tableAlias",e.target.getAttribute("tablealias")||""),e.dataTransfer.setData("tableHidden",e.target.getAttribute("tablehidden")||!1),e.dataTransfer.setData("pathHidden",e.target.getAttribute("pathhidden")||!1),e.dataTransfer.setData("outputTableHidden",e.target.getAttribute("outputtablehidden")||!1)},a.makeMLSQL=function(e){a.queryApp.appendToEditor(e)},a.renderPop=function(){return a.state.etPop?n.createElement(Ce,{parent:Object(d.a)(Object(d.a)(a)),title:a.state.popName}):null},a.queryApp=e.parent,a.state={},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return n.createElement("div",null,n.createElement(_.a,{style:{margin:"0px 0px",padding:"0px 0px"}},n.createElement(xe,{header:"Quick Menu",key:"1"},n.createElement(Q.a,{gutter:16},n.createElement(H.a,{span:8},n.createElement(G.a,{title:"Load/Save Data"},n.createElement(De.a,{tyle:{marginBottom:"10px"},title:"Load/Save Data",onDragStart:this.onDragStart,name:"load",help:"Load file/db as table",draggable:!0,color:"magenta"},"Load data"),n.createElement(De.a,{tyle:{marginBottom:"10px"},title:"Save Data",onDragStart:this.onDragStart,name:"save",help:"Save table into file/db ",draggable:!0,color:"magenta"},"Save data"))),n.createElement(H.a,{span:8},n.createElement(G.a,{title:"Algorithms"},n.createElement(De.a,{tyle:{marginBottom:"10px"},onDragStart:this.onDragStart,name:"TfIdfInPlace",help:"Use TfIdfInPlace vectorize text",draggable:!0,color:"magenta"},"TfIdf"),n.createElement(De.a,{tyle:{marginBottom:"10px"},onDragStart:this.onDragStart,name:"Word2VecInPlace",help:"Use Word2VecInPlace vectorize text",draggable:!0,color:"magenta"},"Word2vec"),n.createElement(De.a,{tyle:{marginBottom:"10px"},onDragStart:this.onDragStart,name:"RandomForest",help:"Use RandomForest to train a model",draggable:!0,color:"magenta"},"RandomForest"),n.createElement(De.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,name:"PythonAlg",help:"Run python lib to train",draggable:!0,color:"magenta"},"Python Algorithm"),n.createElement(De.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,name:"BigDLClassifyExt",help:"Use BigDL to develop deep learning algorithm",draggable:!0,color:"magenta"},"Deep Learning"))),n.createElement(H.a,{span:8},n.createElement(G.a,{title:"Python"},n.createElement(De.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,name:"PythonEnvExt",processtype:"tool",help:"Create Python Env",pathalias:"Temp directory",tablehidden:"true",pathhidden:"false",outputtablehidden:"true",draggable:!0,color:"magenta"},"Create Python Env"),n.createElement(De.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,name:"PythonParallelExt",processtype:"tool",help:"Run python project",pathalias:"Temp directory",tablehidden:"true",pathhidden:"false",outputtablehidden:"true",draggable:!0,color:"magenta"},"Run python project")))),n.createElement("br",null),n.createElement(Q.a,{gutter:16},n.createElement(H.a,{span:8},n.createElement(G.a,{title:"Register model as Function"},n.createElement(De.a,{onDragStart:this.onDragStart,name:"ScriptUDF",processtype:"tool",help:"Use ScriptUDF create udf",draggable:!0,color:"magenta"},"Create UDF"),n.createElement(De.a,{onDragStart:this.onDragStart,name:"register",help:"Register model to function ",pathalias:"Model saved path",outputtablealias:"Function name",tablealias:"Function name",tablehidden:"true",pathhidden:"false",outputtablehidden:"false",draggable:!0,color:"magenta"},"Register Model As Function"))),n.createElement(H.a,{span:8},n.createElement(G.a,{title:"Jobs"},n.createElement(De.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,name:"JobList",processtype:"direct",draggable:!0,color:"magenta"},"Show jobs"),n.createElement(De.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,name:"Kill",processtype:"tool",pathalias:"groupId or jobName",tablehidden:"true",help:"Kill your job",draggable:!0,color:"magenta"},"Kill job"))),n.createElement(H.a,{span:8},n.createElement(G.a,{title:"Tools"},n.createElement(De.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,name:"DownloadExt",processtype:"tool",help:"Use DownloadExt to download files you have uploaded",draggable:!0,color:"magenta"},"Download uploaded file"),n.createElement(De.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,name:"ImageLoaderExt",processtype:"tool",help:"Use ImageLoaderExt to load images",pathalias:"",tablehidden:"true",pathhidden:"true",outputtablehidden:"false",draggable:!0,color:"magenta"},"Load images"),n.createElement(De.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,name:"ConnectMySQL",processtype:"direct",help:"",draggable:!0,color:"magenta"},"Connect MySQL"),n.createElement(De.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,name:"JDBC",processtype:"tool",pathalias:"DB name in connect",tablehidden:"false",help:"Run DLL on MySQL",draggable:!0,color:"magenta"},"MySQL DDL"),n.createElement(De.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,name:"TreeBuildExt",processtype:"tool",pathalias:"",tablehidden:"false",pathhidden:"true",help:"Build tree from parent-child",draggable:!0,color:"magenta"},"Parent-Child"),n.createElement(De.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,name:"ETExample",processtype:"",help:"Show Example of ET",draggable:!0,color:"magenta"},"Show ET Example"),n.createElement(De.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,name:"RepartitionExt",processtype:"tool",help:"Change Table Partition Num",pathalias:"",tablehidden:"false",pathhidden:"true",outputtablehidden:"false",draggable:!0,color:"magenta"},"Repartition table"),n.createElement(De.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,name:"SendMessage",processtype:"tool",help:"Send email",pathalias:"",tablehidden:"false",pathhidden:"true",outputtablehidden:"true",draggable:!0,color:"magenta"},"Send Mail"),n.createElement(De.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,name:"CacheExt",processtype:"tool",help:"Cache table",pathalias:"",tablehidden:"false",pathhidden:"true",outputtablehidden:"true",draggable:!0,color:"magenta"},"Cache Table"),n.createElement(De.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,name:"StringIndex",processtype:"tool",help:"Convert String to number",pathalias:"Mapping path",tablehidden:"false",pathhidden:"false",outputtablehidden:"true",draggable:!0,color:"magenta"},"Convert String to number"),n.createElement(De.a,{style:{marginBottom:"10px"},onDragStart:this.onDragStart,name:"DownloadFile",processtype:"tool",help:"Download File",pathalias:"Target file",tablehidden:"true",pathhidden:"false",outputtablehidden:"true",draggable:!0,color:"magenta"},"Download File to computer")))))),this.renderPop())}}]),t}(n.Component)),Re=function e(){Object(i.a)(this,e),this.makeSQL=function(e){return"JobList"===e?"load _mlsql_.`jobs` as output;":"ConnectMySQL"===e?'connect jdbc where\n url="jdbc:mysql://127.0.0.1:3306/wow?characterEncoding=utf8&zeroDateTimeBehavior=convertToNull&tinyInt1isBit=false"\n and driver="com.mysql.jdbc.Driver"\n and user=""\n and password=""\n as db_1;':""}},Le=a(199),Pe=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).text=function(e,t){a.setState({value:e,scriptId:t}),a.aceEditorRef.current.editor.setValue(e)},a.executeSave=function(){var e=new k(D),t=Object(d.a)(Object(d.a)(a)),n=a.getMessageBoxAceEditor();t.state.scriptId?e.request(v.POST,{id:t.state.scriptId,content:t.getAceEditor().getValue()},function(e){n.setValue("saved")},function(e){}):n.setValue("no file are opened, cannot executeSave")},a.executeQuery=function(){var e=Le();a.enterLoading(e);var t=new k(R),n=Object(d.a)(Object(d.a)(a));n.getMessageBoxAceEditor().setValue("");var r=n.getSelection(),o=n.getAllText();""!==r&&(o=r);var l=(new Date).getTime();function i(){return n.exitLoading(),(new Date).getTime()-l}t.runScript({jobName:e,background:a.state.background||!1},o,function(e){try{n.queryApp.setData(e),n.getDisplay().update(e),n.getMessageBoxAceEditor().setValue("\nTime cost:"+i()+"ms")}catch(t){console.log(t),n.getMessageBoxAceEditor().setValue("Can not display the result. raw data:\n"+JSON.stringify(e,null,2))}n.exitLoading()},function(e){var t=e.toString();try{t=JSON.parse(t).msg}catch(a){}n.getMessageBoxAceEditor().setValue(t+"\nTime cost:"+i()+"ms"),n.exitLoading()})},a.getAllText=function(){return a.getAceEditor().getValue()},a.getSelection=function(){var e=a.getAceEditor().getSelectionRange();return a.getAceEditor().session.getTextRange(e)},a.appendToEditor=function(e){var t=a.getAceEditor(),n=t.getCursorPosition();t.session.insert(n,e),t.focus()},a.getAceEditor=function(){return a.aceEditorRef.current.editor},a.getMessageBoxAceEditor=function(){return a.queryApp.messageBox.current.editor},a.getDashBoard=function(){return a.queryApp.dash.current},a.getDisplay=function(){return a.queryApp.display.current},a.enterLoading=function(e){a.commandGroup.current.setState({loading:!0}),a.resourceProgressRef.current.enter({jobName:e}),a.taskProgressRef.current.enter({jobName:e})},a.exitLoading=function(){a.commandGroup.current.setState({loading:!1}),a.resourceProgressRef.current.exit(),a.taskProgressRef.current.exit()},a.etOver=function(e){var t=e.dataTransfer.getData("eventName"),n=e.dataTransfer.getData("popName"),r=e.dataTransfer.getData("processType"),o=e.dataTransfer.getData("pathAlias"),l=e.dataTransfer.getData("tableHidden"),i=e.dataTransfer.getData("pathHidden"),c=e.dataTransfer.getData("outputTableHidden"),s=e.dataTransfer.getData("outputTableAlias"),u=e.dataTransfer.getData("tableAlias");"direct"===r?a.appendToEditor((new Re).makeSQL(t)):a.etRef.current.setState({etPop:!0,eventName:t,popName:n,processType:r,pathAlias:o,tableHidden:l,pathHidden:i,outputTableHidden:c,outputTableAlias:s,tableAlias:u})},a.queryApp=a.props.parent,a.aceEditorRef=n.createRef(),a.commandGroup=n.createRef(),a.resourceProgressRef=n.createRef(),a.taskProgressRef=n.createRef(),a.etRef=n.createRef(),a.state={value:"",loading:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"onChange",value:function(e){}},{key:"render",value:function(){return n.createElement("div",{className:"mlsql-editor-area"},n.createElement("div",null,n.createElement(Ne,{ref:this.etRef,parent:this})),n.createElement("div",{onDragOver:function(e){return e.preventDefault()},onDrop:this.etOver},n.createElement(B.a,{ref:this.aceEditorRef,mode:"sql",theme:"github",width:"100%",height:"300px",onChange:this.onChange,name:"mlsql_editor",fontSize:16,showPrintMargin:!0,showGutter:!0,highlightActiveLine:!0,value:"",editorProps:{$blockScrolling:1/0},setOptions:{enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,enableSnippets:!1,showLineNumbers:!0,tabSize:2}})),n.createElement(Me,{ref:this.commandGroup,parent:this}),n.createElement(Ve,{ref:this.resourceProgressRef,parent:this}),n.createElement(Ae,{ref:this.taskProgressRef,parent:this}))}}]),t}(n.Component),Me=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={loading:!1},a.parent=e.parent,a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return n.createElement("div",{className:"mslql-editor-buttons"},n.createElement(I.a,{onClick:this.parent.executeQuery,loading:this.state.loading},"Run"),n.createElement(I.a,{onClick:this.parent.executeSave},"Save"))}}]),t}(n.Component),Ve=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).enter=function(e){var t=Object(d.a)(Object(d.a)(a));a.setState({mark:!0}),setTimeout(function(){t.state.mark&&(t.setState({loading:!0}),t.intervalTimer=setInterval(function(){var a=new k(R);q(e.hasOwnProperty("jobName"),"jobName is required");var n=e.jobName;a.runScript({},"load _mlsql_.`resource/".concat(n,"` as output;"),function(e){var a=e[0];t.setState({percent:a.activeTasks/a.totalCores*100,successPercent:a.currentJobGroupActiveTasks/a.totalCores*100,title:"Resource (for all users): taken/Total: ".concat(a.activeTasks,"/").concat(a.totalCores,"(").concat(a.currentJobGroupActiveTasks," you took)")})},function(e){try{t.parent.getMessageBoxAceEditor().setValue(e)}catch(a){console.log(a)}})},2e3))},3e3)},a.exit=function(){a.setState({loading:!1,percent:0,successPercent:0,mark:!1}),a.intervalTimer&&clearInterval(a.intervalTimer)},a.state={loading:!1,percent:0,successPercent:0,mark:!1},a.parent=e.parent,a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return this.state.loading?n.createElement("div",null,this.state.title,n.createElement(F.a,{percent:this.state.percent,successPercent:this.state.successPercent})):n.createElement("div",null)}}]),t}(n.Component),Ae=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).enter=function(e){var t=Object(d.a)(Object(d.a)(a));a.setState({mark:!0}),setTimeout(function(){t.state.mark&&(t.setState({loading:!0}),t.intervalTimer=setInterval(function(){var a=new k(R);q(e.hasOwnProperty("jobName"),"jobName is required");var n=e.jobName;a.runScript({},"load _mlsql_.`jobs/".concat(n,"` as output;"),function(e){var a=e[0],n={numTasks:0,numActiveTasks:0,numCompletedTasks:0};a.activeJobs.forEach(function(e){n.numTasks+=e.numTasks,n.numActiveTasks+=e.numActiveTasks,n.numCompletedTasks+=e.numCompletedTasks}),t.setState({percent:n.numActiveTasks/n.numTasks*100,successPercent:n.numCompletedTasks/n.numTasks*100,title:"Tasks (for all stages): Succeeded/Total:\n".concat(n.numCompletedTasks,"/").concat(n.numTasks,"(").concat(n.numActiveTasks," running)")})},function(e){try{t.parent.getMessageBoxAceEditor().setValue(e)}catch(a){console.log(a)}})},2e3))},3e3)},a.exit=function(){a.setState({loading:!1,percent:0,successPercent:0,mark:!1}),a.intervalTimer&&clearInterval(a.intervalTimer)},a.state={loading:!1,percent:0,successPercent:0,mark:!1},a.parent=e.parent,a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return this.state.loading?n.createElement("div",null,this.state.title,n.createElement(F.a,{percent:this.state.percent,successPercent:this.state.successPercent})):n.createElement("div",null)}}]),t}(n.Component),Be=Pe,Ie=a(235),Fe=a(465),qe=a(76),_e=a(77),Ue=a(75),Qe=a(751),He=a(78),Ge=a(79),ze=a(2),Je=a.n(ze),We=(a(455),function e(){Object(i.a)(this,e),this.build=function(e){var t,a,n={},r=[];for(a=0;a<e.length;a+=1)n[e[a].id]=a,e[a].childNodes=[];for(a=0;a<e.length;a+=1)if(0!==(t=e[a]).parentId)try{e[n[t.parentId]].childNodes.push(t)}catch(o){console.log("------------"),console.log(t),console.log(n[t.parentId])}else r.push(t);return r}}),Ke=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).reloadData=function(){var e=new k(D),t=Object(d.a)(Object(d.a)(a));e.request(v.GET,{},function(e){e.content.then(function(e){var a=[];try{a=JSON.parse(e||"[]")}catch(r){}var n=(new We).build(a).sort(function(e,t){return e.id-t.id});t.setState({nodes:n})})},function(e){})},a.isRootNode=function(e){return a.state.nodes[0].id===e},a.onNodeContextMenu=function(e,t,r){r.preventDefault();var o=Object(d.a)(Object(d.a)(a));Qe.a.show(n.createElement(Ye,{parent:o,nodeId:e.id}),{left:r.clientX,top:r.clientY},function(){return a.setState({isContextMenuOpen:!1})}),a.setState({isContextMenuOpen:!0})},a.handNodeDoubleClick=function(e,t,n){if(e.isDir)e.isExpanded=!e.isExpanded,a.toggleIsExpanded(e.id,e.isExpanded);else{var r=new k(N),o=Object(d.a)(Object(d.a)(a));r.request(v.GET,{id:e.id},function(t){t.content.then(function(t){var a=JSON.parse(t||"{}");o.parent.editor.current.text(a.content,e.id)})},function(e){})}a.setState(a.state)},a.handleNodeClick=function(e,t,n){var r=e.isSelected;n.shiftKey||a.forEachNode(a.state.nodes,function(e){return e.isSelected=!1}),e.isSelected=null==r||!r,a.setState(a.state)},a.toggleIsExpanded=function(e,t){var n=new k(D);Object(d.a)(Object(d.a)(a));n.request(v.POST,{id:e,isExpanded:t},function(e){e.content.then(function(e){})},function(e){})},a.handleNodeCollapse=function(e){e.isExpanded=!1,a.setState(a.state)},a.handleNodeExpand=function(e){e.isExpanded=!0,a.setState(a.state)},a.state={isContextMenuOpen:!1,openCreateScriptDialog:!1},a.parent=a.props.parent,a.reloadData(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return n.createElement("div",null,n.createElement(Ie.a,{contents:this.state.nodes,onNodeClick:this.handleNodeClick,onNodeCollapse:this.handleNodeCollapse,onNodeExpand:this.handleNodeExpand,onNodeContextMenu:this.onNodeContextMenu,onNodeDoubleClick:this.handNodeDoubleClick,className:"mlsql-directory-tree"}),this.state.openCreateScriptDialog?n.createElement($e,{nodeId:this.state.nodeId,parent:this,queryApp:this.parent}):"")}},{key:"forEachNode",value:function(e,t){if(null!=e){var a=!0,n=!1,r=void 0;try{for(var o,l=e[Symbol.iterator]();!(a=(o=l.next()).done);a=!0){var i=o.value;t(i),this.forEachNode(i.childNodes,t)}}catch(c){n=!0,r=c}finally{try{a||null==l.return||l.return()}finally{if(n)throw r}}}}}]),t}(n.Component),$e=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).title=function(){return a.props.parent.state.isDir?"Create Folder":"Create Script"},a.fileName=function(e){a.setState({fileName:e.target.value})},a.content=function(e){a.setState({content:e.target.value})},a.finish=function(){a.props.parent.setState({openCreateScriptDialog:!1}),a.props.parent.reloadData()},a.create=function(){var e=new k(D),t=Object(d.a)(Object(d.a)(a)),n={fileName:a.state.fileName,isDir:a.props.parent.state.isDir,content:a.state.content,parentId:a.props.nodeId};n.fileName?n.isDir||n.fileName.endsWith(".mlsql")?e.request(v.POST,n,function(e){e.status===y.Success?t.finish():e.content.then(function(e){a.setState({msg:e})})},function(e){t.setState({msg:"Server error"})}):a.setState({msg:"filename should be ends with .mlsql"}):a.setState({msg:"filename should not be empty"})},a.close=function(){var e=a.props.parent;e.setState({openCreateScriptDialog:!1}),e.reloadData()},a.state={msg:""},a.messageBox=a.props.queryApp.messageBox.current.editor,a.directoryTree=a.props.parent,a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=Je()(Fe.a.CARD,Fe.a.ELEVATION_4,"docs-md-overlay-example-transition");return n.createElement("div",null,n.createElement(qe.a,{className:"msql-treenode-dialog",isOpen:!0,usePortal:!0},n.createElement("div",{className:e},n.createElement(_e.a,null,this.title()," "),n.createElement("div",{className:"msql-treenode-dialog-form"},n.createElement("p",{style:{color:"red"}},this.state.msg),n.createElement(b.a,{helperText:"The file of name you want create.",label:"fileName",labelFor:"fileName",labelInfo:"(required)"},n.createElement(E.a,{id:"fileName",placeholder:"example.mlsql",onChange:this.fileName}))),n.createElement("br",null),n.createElement(f.a,{onClick:this.create},"Create"),n.createElement(f.a,{intent:Ue.a.DANGER,onClick:this.close,style:{float:"right"}},"Close"))))}}]),t}(n.Component),Ye=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).removeFile=function(){var e=new k(x),t=Object(d.a)(Object(d.a)(a));e.request(v.POST,{id:t.nodeId},function(e){e.status===y.Success?t.parent.reloadData():e.content.then(function(e){t.parent.setState({msg:e})})},function(e){t.parent.setState({msg:"Server error"})})},a.isCreateProject=function(){return a.parent.isRootNode(a.nodeId)},a.createDocMenuItem=function(){if(!a.isCreateProject())return n.createElement(He.a,{icon:"document",text:"Create Script",onClick:function(){a.parent.setState({openCreateScriptDialog:!0,nodeId:a.nodeId,isDir:!1})}.bind(Object(d.a)(Object(d.a)(a)))})},a.createFolderTitle=function(){return a.isCreateProject()?"Create Project":"Create Folder"},a.deleteMenu=function(){if(!a.isCreateProject())return n.createElement(He.a,{icon:"remove",text:"Delete",onClick:function(){a.removeFile()}.bind(Object(d.a)(Object(d.a)(a)))})},a.parent=a.props.parent,a.nodeId=a.props.nodeId,a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return n.createElement("div",null,n.createElement(Ge.a,null,this.createDocMenuItem(),n.createElement(He.a,{icon:"folder-new",text:this.createFolderTitle(),onClick:function(){e.parent.setState({openCreateScriptDialog:!0,nodeId:e.nodeId,isDir:!0})}.bind(this)}),this.deleteMenu()))}}]),t}(n.Component),Ze=(a(238),a(743)),Xe=a(174),et=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).setRender=function(e,t){var r=t[0][e.key];if(a.state.config&&a.state.config.render){var o=a.state.config.render[e.key];o&&(e.render=o)}else n.Component.isPrototypeOf(r.type)?e.render=function(e){return n.createElement("span",null,e)}:"object"!==typeof r?"array"!==typeof r?"boolean"!==typeof r||(e.render=function(e){return n.createElement("span",null,e.toString())}):e.render=function(e){return n.createElement("span",null,e.join(",").substring(0,300))}:e.render=function(e){return n.createElement("span",null,JSON.stringify(e).substring(0,300))}},a.update=function(e,t){a.setState({config:t});var n=[],r={},o=[],l=Object(d.a)(Object(d.a)(a));e.forEach(function(t){for(var a in t)if(!r[a]){var o={title:a,dataIndex:a,key:a};l.setRender(o,e),n.push(o),r[a]=!0}}),e.forEach(function(e,t){var a={};n.forEach(function(t){a[t.key]=e[t.key]}),a.key=t,o.push(a)}),a.setState({columns:n,data:o})},a.rowDoubleClick=function(e,t,n){"codeExample"!==e.name&&"doc"!==e.name||a.setState({view:{enabled:!0,content:e.value}})},a.disablePreview=function(){a.setState({view:{enabled:!1}})},a.state={columns:[],rows:[],view:{enabled:!1}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return n.createElement("div",null,n.createElement(Ze.a,{onRow:function(t,a){return{onDoubleClick:function(n){e.rowDoubleClick(t,a,n)}}},columns:this.state.columns,dataSource:this.state.data}),n.createElement(J.a,{title:"View",visible:this.state.view.enabled,onCancel:this.disablePreview,onOk:this.disablePreview,cancelText:"Cancel",OkText:"Ok"},n.createElement(Xe,{source:this.state.view.content||""})))}}]),t}(n.Component),tt=a(153),at=a(311),nt=a(310),rt=a(308),ot=a.n(rt),lt={width:200,height:200,borderWidth:2,borderColor:"#666",borderStyle:"dashed",borderRadius:5},it={borderStyle:"solid",borderColor:"#6c6",backgroundColor:"#eee"},ct={borderStyle:"solid",borderColor:"#c66",backgroundColor:"#eee"},st={display:"flex"},ut=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).onDrop=function(t){e.setState({files:t});var a=ot.a.post(P);a.set("Access-Token",sessionStorage.getItem(S.name)||""),t.forEach(function(e){a.attach(e.path,e)}),a.end(function(a,n){e.setState({files:[]}),a?(console.log(a),e.setState({msg:a.toString()+"\n Sometimes this caused by your upload space is not enough."})):n.ok&&e.setState({msg:"total files:"+t.length+" are uploaded"})})},e.state={files:[]},e}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.state.files.map(function(e){return r.a.createElement("li",{key:e.name},e.path," - ",e.size," bytes")});return r.a.createElement("section",{style:st},r.a.createElement("div",null,r.a.createElement(at.a,{onDrop:this.onDrop,getDataTransferItems:function(e){return Object(nt.a)(e)}},function(e){var t=e.getRootProps,a=e.getInputProps,n=e.isDragActive,o=e.isDragAccept,l=e.isDragReject,i=(e.acceptedFiles,e.rejectedFiles,Object(tt.a)({},lt));return i=n?Object(tt.a)({},i,it):i,i=l?Object(tt.a)({},i,ct):i,r.a.createElement("div",Object.assign({},t(),{style:i}),r.a.createElement("input",a()),r.a.createElement("div",null,o?"Drop":"Drag"," files here..."),l&&r.a.createElement("div",null,"Unsupported file type..."))})),r.a.createElement("aside",null,r.a.createElement("h4",null,0==e.length?"":"Files"),r.a.createElement("ul",null,e)),r.a.createElement("div",null,this.state.msg?this.state.msg:""))}}]),t}(r.a.Component),mt=(a(625),a(196)),dt=a(197),pt=a.n(dt),ht=_.a.Panel,ft=U.a.TabPane;function gt(e){}var bt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).isStream=function(e){if(e.length<1)return!1;try{if(!JSON.parse(e[0].value).runId)return!1}catch(t){return!1}return!0},a.renderDash=function(){var e=a.state.data;return a.isStream(e)?r.a.createElement("div",null,r.a.createElement(mt.TimelineChart,{height:200,data:a.state.dataForRender,titleMap:a.state.titleMap}),r.a.createElement(mt.TimelineChart,{height:200,data:a.state.dataForRender2,titleMap:a.state.titleMap2})):r.a.createElement("div",null)},a.renderStream=function(){var e=a.state.data;if(a.isStream(e)){var t=[],n=[];e.forEach(function(e){var a=JSON.parse(e.value);t.push({x:pt.a.utc(a.timestamp).toDate().getTime(),y1:a.inputRowsPerSecond,y2:a.processedRowsPerSecond}),n.push({x:pt.a.utc(a.timestamp).toDate().getTime(),y1:a.numInputRows})}),a.setState({dataForRender:t,titleMap:{y1:"inputRowsPerSecond",y2:"processedRowsPerSecond"},dataForRender2:n,titleMap2:{y1:"numInputRows"}})}},a.renderRawData=function(){var e=a.state.data;if(!a.isStream(e))return"";var t=[];return e.forEach(function(e){var a=JSON.parse(e.value);t.push(JSON.stringify(a,null,2))}),t.join("\n")},a.queryApp=e.parent,a.state={data:[],dataForRender:[],titleMap:{}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"refresh",value:function(){try{var e=this.queryApp.queryResData||[];this.setState({data:e}),this.renderStream()}catch(t){}}},{key:"render",value:function(){return r.a.createElement(_.a,{onChange:gt},r.a.createElement(ht,{header:"Tools/Dashboard",key:"1"},r.a.createElement(U.a,{defaultActiveKey:"1",onChange:gt},r.a.createElement(ft,{tab:"Upload",key:"1"},r.a.createElement(ut,null)),r.a.createElement(ft,{tab:"Dashboard",key:"2"},this.renderDash()),r.a.createElement(ft,{tab:"RawData",key:"3"},r.a.createElement("pre",null,this.renderRawData())))))}}]),t}(n.Component),Et=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).setData=function(e){a.queryResData=e,a.dash.current.refresh()},a.state={sqlContent:""},a.directoryTree=r.a.createRef(),a.editor=r.a.createRef(),a.messageBox=r.a.createRef(),a.display=r.a.createRef(),a.dash=r.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"mlsql-queryapp"},r.a.createElement("div",{className:"mlsql-directory-tree"},r.a.createElement(Ke,{ref:this.directoryTree,parent:this})),r.a.createElement("div",{className:"mlsql-editor"},r.a.createElement(Be,{ref:this.editor,parent:this}),r.a.createElement("div",{className:"mlsql-messagebox"},r.a.createElement(B.a,{height:"100px",width:"100%",ref:this.messageBox,mode:"text",theme:"github",name:"message_box"})),r.a.createElement("div",null,r.a.createElement(bt,{ref:this.dash,parent:this})),r.a.createElement("div",{className:"mlsql-query-display"},r.a.createElement(et,{ref:this.display,parent:this}))))}}]),t}(n.Component),vt="cluster",yt="console",St="demo",Ot="BackendForm",wt="BackendList",jt="SetBackendTags",kt="bigdl",Ct="nlp",Tt=a(748),Dt=a(736),xt=a(22),Nt=a(750),Rt=(a(728),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e)))._submit=function(){var e=a.state,t=e.name,n=e.url,r=e.tag,o=new k(L),l=Object(d.a)(Object(d.a)(a));o.request2({action:"/backend/add",name:t,tag:r,url:n},function(e){l.clusterMainPage.switchToBackendList()},function(e){a.setState({msg:e})})},a.submit=function(){a.validateForm()},a.validateForm=function(){var e=a.state,t=e.name,n=e.url,r=e.tag;if(t&&n&&r)if(n.includes(":")){var o=Object(d.a)(Object(d.a)(a));new k(L).request2({action:"/backend/list"},function(e){new Set(e.map(function(e){return e.name})).has(t)?a.setState({msg:"".concat(t," exists")}):o._submit()},function(e){a.setState({msg:e})})}else a.setState({msg:"".concat(n," should format like: ip/dns:port  ")});else a.setState({msg:"name, url ,tag should not empty"})},a.setName=function(e){a.setState({name:e.target.value})},a.setTag=function(e){a.setState({tag:e.target.value})},a.setUrl=function(e){a.setState({url:e.target.value})},a.state={msg:""},a.clusterMainPage=e.parent,a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return n.createElement("div",null,n.createElement(b.a,{helperText:"name",label:"the name of backend",labelFor:"name",labelInfo:"(required)"},n.createElement(E.a,{id:"name",onChange:this.setName,placeholder:"name"})),n.createElement(b.a,{helperText:"multi tag please use comma separate",label:"tag",labelFor:"tag",labelInfo:"(required)"},n.createElement(E.a,{id:"tag",onChange:this.setTag,placeholder:"tag"})),n.createElement(b.a,{helperText:"address",label:"url",labelFor:"url",labelInfo:"(required)"},n.createElement(E.a,{id:"url",onChange:this.setUrl,placeholder:"url e.g. 127.0.0.1:9003"})),n.createElement(f.a,{type:"submit",text:"Add",onClick:this.submit}),""!==this.state.msg&&n.createElement("div",{className:"mlsql-backend-messagebox"},this.state.msg))}}]),t}(n.Component)),Lt=K.a.Option,Pt=function(e){function t(e){var a;Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).renderTags=function(){var e=Object(d.a)(Object(d.a)(a));new k(L).request2({action:"/backend/list"},function(t){t.forEach(function(t){t.tag.split(",").forEach(function(t){e.state.renderTags.push(n.createElement(Lt,{key:t},t))})})},function(t){e.setState({msg:t})})},a.renderUsers=function(){var e=Object(d.a)(Object(d.a)(a));new k(T).request2({},function(t){t.forEach(function(t){e.state.renderUsers.push(n.createElement(Lt,{key:t},t))})},function(t){e.setState({msg:t})})},a.setTag=function(e){a.setState({updateTag:e})},a.setUser=function(e){a.setState({updateUser:e})},a.setDefaultBackend=function(){var e=Object(d.a)(Object(d.a)(a)),t=new k(C),n=(a.state.updateTag||[]).join(","),r=(a.state.updateUser||[]).join(",");n&&t.request2({backendTags:n,users:r},function(t){e.mainPage.switchToBackendList()},function(t){e.setState({msg:t})})},a.mainPage=e.parent,a.state={tags:[],renderTags:[],renderUsers:[]},a.tagSelectRef=n.createRef(),a.userSelectRef=n.createRef();var r=Object(d.a)(Object(d.a)(a));return(new V).user(function(e){e.userName;var t=e.backendTags;t&&(console.log(t.split(",")),r.setState({tags:t.split(",")})),r.renderTags(),r.renderUsers()}),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return n.createElement("div",null,"Backend Tag:",n.createElement("div",{style:{margin:"10px 0px"}},n.createElement(K.a,{mode:"multiple",style:{width:"100%"},placeholder:"Please select",onChange:this.setTag,ref:this.tagSelectRef},this.state.renderTags)),"For Users:",n.createElement("div",{style:{margin:"10px 0px"}},n.createElement(K.a,{mode:"multiple",style:{width:"100%"},placeholder:"Please select",onChange:this.setUser,ref:this.userSelectRef},this.state.renderUsers)),n.createElement(I.a,{type:"primary",onClick:function(){e.setDefaultBackend()}},"Update"),n.createElement("div",null),this.state.msg&&n.createElement("div",{className:"mlsql-backend-messagebox"},this.state.msg))}}]),t}(n.Component),Mt=Tt.a.Header,Vt=Tt.a.Content,At=Tt.a.Footer,Bt=Tt.a.Sider,It=(Dt.a.SubMenu,function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).deleteBackend=function(e){var t=Object(d.a)(Object(d.a)(a));new k(L).request2({id:e,action:"/backend/remove"},function(e){t.switchToBackendList()},function(e){})},a.loadBackends=function(){var e=Object(d.a)(Object(d.a)(a)),t=new k(L);(new V).user(function(a){a.userName;var r=a.backendTags;t.request2({action:"/backend/list"},function(t){t.forEach(function(t){var a="";r==t.tag&&(a=n.createElement(I.a,{disabled:!0,style:{color:"green"},type:"primary"},"Active")),t.status=a,t.operator=n.createElement("div",null,n.createElement(I.a,{type:"danger",onClick:function(){e.deleteBackend(t.id)}},"delete")),delete t.tags}),e.tableDisplayRef.current.update(t,{render:{operator:function(e){return n.createElement("span",null,e)},status:function(e){return n.createElement("span",null,e)}}})},function(e){})})},a.switchToBackendForm=function(){a.setState({currentView:Ot})},a.switchToBackendList=function(){a.setState({currentView:wt}),a.loadBackends()},a.switchToSetBackendTags=function(){a.setState({currentView:jt})},a.renderView=function(){return a.state.currentView==wt?(a.loadBackends(),n.createElement(et,{ref:a.tableDisplayRef,parent:Object(d.a)(Object(d.a)(a))})):a.state.currentView==Ot?n.createElement(Rt,{ref:a.backendFormRef,parent:Object(d.a)(Object(d.a)(a))}):a.state.currentView==jt?n.createElement(Pt,{ref:a.setBackendTagsViewRef,parent:Object(d.a)(Object(d.a)(a))}):void 0},a.renderViewIndex=function(){return a.state.currentView==wt?"1":a.state.currentView==Ot?"2":a.state.currentView==jt?"3":"1"},a.onCollapse=function(e){a.setState({collapsed:e})},a.state={collapsed:!1,currentView:wt},a.tableDisplayRef=n.createRef(),a.backendFormRef=n.createRef(),a.setBackendTagsViewRef=n.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return n.createElement(Tt.a,{style:{minHeight:"100vh"}},n.createElement(Bt,{collapsible:!0,collapsed:this.state.collapsed,onCollapse:this.onCollapse},n.createElement("div",{className:"logo"}),n.createElement(Dt.a,{theme:"dark",defaultSelectedKeys:[this.renderViewIndex()],mode:"inline"},n.createElement(Dt.a.Item,{key:"1"},n.createElement(xt.a,{type:"desktop"}),n.createElement("span",null,n.createElement("a",{style:{color:"white"},onClick:this.switchToBackendList},"List Backend"))),n.createElement(Dt.a.Item,{key:"2"},n.createElement(xt.a,{type:"desktop"}),n.createElement("span",null,n.createElement("a",{style:{color:"white"},onClick:this.switchToBackendForm},"Add Backend"))),n.createElement(Dt.a.Item,{key:"3"},n.createElement(xt.a,{type:"desktop"}),n.createElement("span",null,n.createElement("a",{style:{color:"white"},onClick:this.switchToSetBackendTags},"Set Console Backend"))))),n.createElement(Tt.a,null,n.createElement(Mt,{style:{background:"#fff",padding:0}}),n.createElement(Vt,{style:{margin:"0 16px"}},n.createElement(Nt.a,{style:{margin:"16px 0"}},n.createElement(Nt.a.Item,null)),n.createElement("div",{style:{padding:24,background:"#fff",minHeight:360}},this.renderView())),n.createElement(At,{style:{textAlign:"center"}})))}}]),t}(n.Component)),Ft=function(e){function t(e){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).call(this,e))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return n.createElement("div",null,n.createElement(It,null))}}]),t}(n.Component),qt=a(747),_t=a(752),Ut=a(741),Qt=qt.a.Step,Ht=a(174),Gt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).setData=function(e){a.queryResData=e,a.dash.current.refresh()},a.getEditor=function(){return a.editor.current.aceEditorRef.current.editor},a.state={current:0},a.editor=n.createRef(),a.dash=n.createRef(),a.display=n.createRef(),a.messageBox=n.createRef(),a.techData=a.generateTechData(),a.commandData=a.generateCommandData(),a.steps=a.generateSteps(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"generateView",value:function(e){return n.createElement("div",{style:{marginTop:"30px"}},this.techData[e].length>0&&n.createElement(_t.a,{header:n.createElement("div",null,"How to do:"),footer:n.createElement("div",null,"Congratulations"),bordered:!0,dataSource:this.techData[e],renderItem:function(e){return n.createElement(_t.a.Item,null,e)}}),n.createElement("div",{className:"mlsql-queryapp"},n.createElement("div",{className:"mlsql-editor"},n.createElement(Be,{ref:this.editor,parent:this}),n.createElement("div",{className:"mlsql-messagebox"},n.createElement(B.a,{height:"100px",width:"100%",ref:this.messageBox,mode:"text",theme:"github",name:"message_box"})),n.createElement("div",null,n.createElement(bt,{ref:this.dash,parent:this})),n.createElement("div",{className:"mlsql-query-display"},n.createElement(et,{ref:this.display,parent:this})))))}},{key:"generateSteps",value:function(){return[{title:"Download Cifar10 Images",content:this.generateView(0)},{title:"Resize Images",content:this.generateView(1)},{title:"Extract Label",content:this.generateView(2)},{title:"Train",content:this.generateView(3)},{title:"Predict",content:this.generateView(4)}]}},{key:"componentDidMount",value:function(){var e=this;setTimeout(function(){e.getEditor().setValue(e.commandData[0],-1)},1e3)}},{key:"next",value:function(){var e=this,t=this.state.current+1;this.setState({current:t}),setTimeout(function(){e.getEditor().setValue(e.commandData[t],-1)},1e3)}},{key:"prev",value:function(){var e=this,t=this.state.current-1;this.setState({current:t}),setTimeout(function(){e.getEditor().setValue(e.commandData[t],-1)},1e3)}},{key:"render",value:function(){var e=this,t=this.state.current;return n.createElement("div",null,n.createElement("div",{className:"steps-action",style:{marginBottom:"30px"}},t<this.steps.length-1&&n.createElement(I.a,{type:"primary",onClick:function(){return e.next()}},"Next Step"),t===this.steps.length-1&&n.createElement(I.a,{type:"primary",onClick:function(){return Ut.a.success("Processing complete!")}},"Done"),t>0&&n.createElement(I.a,{style:{marginLeft:8},onClick:function(){return e.prev()}},"Previous Step")),n.createElement(qt.a,{current:t},this.steps.map(function(e){return n.createElement(Qt,{key:e.title,title:e.title})})),n.createElement("div",{className:"steps-content"},this.steps[t].content))}},{key:"generateTechData",value:function(){return[["Step 0: Clear the content in editor","Step 1: Click Quick Menu","Step 2: Drag Tools/Download uploaded file to Editor","Step 3: An dialog will be opened, fill field [from] with 'public/cifar.tar' and field [to] with '/tmp'","Step 4: Click Ok in dialog","Step 5: Click button Run(Since there are so many files, it will take a while.)"],["Step 0: Clear the content in editor","Step 1: Click Quick Menu","Step 2: Drag Tools/Load images",n.createElement(Ht,{source:"Step 3: An dialog will be opened\nfill field [Output table] with 'images'\nfield [imageDir]  with '/tmp/cifar/train'\nfield [code]  with \n\n```scala\ndef apply(params:Map[String,String]) = {\n         Resize(256, 256) -> CenterCrop(224, 224) ->\n          MatToTensor() -> ImageFrameToSample()\n       }\n```"}),"Step 4: Click Ok in dialog","Step 5: Click button Run"],["Step 0: Use set statement to set a variable named labelMappingPath.","Step 1: extract the class name from path","Step 2: map label string to number","Step 3: add 1 to label number since the bigdl requires that.","Step 4: finally, we get features and label","Step 5: Click button Run"],["Step 0: Clear the content in editor","Step 1: Click Quick Menu","Step 2: Drag Algorithms/Deep Learning",n.createElement(Ht,{source:"Step 3: An dialog will be opened  \nfill field [tableName] with 'trainData'  \nfield [Model save path]  with '/tmp/bigdl' \nfield [code]  with    \n```scala  \n def apply(params:Map[String,String])={\n                        val model = Sequential()\n                        model.add(Reshape(Array(3, 28, 28), inputShape = Shape(28, 28, 3)))\n"+'                        model.add(Convolution2D(6, 5, 5, activation = "tanh").setName("conv1_5x5"))\n                        model.add(MaxPooling2D())\n                        model.add(Convolution2D(12, 5, 5, activation = "tanh").setName("conv2_5x5"))\n                        model.add(MaxPooling2D())\n                        model.add(Flatten())\n                        model.add(Dense(100, activation = "tanh").setName("fc1"))\n                        model.add(Dense(params("classNum").toInt, activation = "softmax").setName("fc2"))\n                    }```  \n'}),"Step 4: Click Ok in dialog",n.createElement(Ht,{source:'Step 5: modify the where statement, add \n```\nfitParam.0.featureSize="[3,28,28]"\nand fitParam.0.classNum="10"\nand fitParam.0.maxEpoch="50"\n```'}),"Step 6: Click button Run"],[]]}},{key:"generateCommandData",value:function(){return['run command as DownloadExt.`` where \n            from="public/cifar.tar" \n            and to="/tmp";'.stripMargin(),"run command as ImageLoaderExt.`/tmp/cifar/train` \n            where code='''\n        def apply(params:Map[String,String]) = {\n         Resize(256, 256) -> CenterCrop(224, 224) ->\n          MatToTensor() -> ImageFrameToSample()\n       }''' as images;".stripMargin(),'-- convert image path to number label \n            set labelMappingPath = "/tmp/si"; \n            select split(split(imageName,"_")[1],"\\\\.")[0] as labelStr,features from images as tempData;\n            --convert the label string to number \n            train tempData as StringIndex.`${labelMappingPath}` where inputCol="labelStr" and outputCol="labelIndex";\n            predict tempData as StringIndex.`${labelMappingPath}` as tempData;\n            -- Since the bigdl need label number from 1, we should plus one\n            select (cast(labelIndex as float) + 1) as label,features from tempData as trainData;'.stripMargin(),'--train with LeNet5 model\n            set modelPath = "/tmp/bigdl";            \n            train trainData as BigDLClassifyExt.`${modelPath}` where\n            fitParam.0.featureSize="[3,28,28]"\n            and fitParam.0.classNum="10"\n            and fitParam.0.maxEpoch="50"\n            and fitParam.0.code=\'\'\'\n            |       def apply(params:Map[String,String])={\n            |            val model = Sequential()\n            |            model.add(Reshape(Array(3, 28, 28), inputShape = Shape(28, 28, 3)))\n            |            model.add(Convolution2D(6, 5, 5, activation = "tanh").setName("conv1_5x5"))\n            |            model.add(MaxPooling2D())\n            |            model.add(Convolution2D(12, 5, 5, activation = "tanh").setName("conv2_5x5"))\n            |            model.add(MaxPooling2D())\n            |            model.add(Flatten())\n            |            model.add(Dense(100, activation = "tanh").setName("fc1"))\n            |            model.add(Dense(params("classNum").toInt, activation = "softmax").setName("fc2"))\n            |        }\'\'\';\n            '.stripMargin(),'set modelPath = "/tmp/bigdl";\n            \n            -- batch predict            \n            predict trainData as BigDLClassifyExt.`${modelPath}` as predictdata;\n            \n            -- register BigDLClassifyExt.`/tmp/bigdl` as cifarPredict;\n            select vec_argmax(cifarPredict(vec_dense(features))) as predicted_label,\n            label from trainData\n            as output;'.stripMargin()]}}]),t}(n.Component),zt=a(174),Jt=function(e){function t(e){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).call(this,e))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"generateSteps",value:function(){return[{title:"Download Dataset SogouCS.WWW08",content:this.generateView(0)},{title:"Parse the xml file",content:this.generateView(1)},{title:"Extract Label",content:this.generateView(2)},{title:"Run TFIDF",content:this.generateView(3)},{title:"Train/Register",content:this.generateView(4)},{title:"Predict",content:this.generateView(5)}]}},{key:"generateTechData",value:function(){return[["Step 0: Clear the content in editor","Step 1: Click Quick Menu","Step 2: Drag Tools/Download uploaded file to Editor","Step 3: An dialog will be opened, fill field [from] with 'public/SogouCS.reduced.tar' and field [to] with '/tmp/nlp/sogo'","Step 4: Click Ok in dialog","Step 5: Click button Run(it will take a while.)"],["Step 0: Clear the content in editor","Step 1: Click Quick Menu","Step 2: Drag Load/Save Data/Load data",n.createElement(zt,{source:"\n                |\n                |Step 3: An dialog will be opened,\n                |fill field [path] with '/tmp/nlp/sogo' and field [Output table] with 'xmlData',\n                |specify rowTag to doc and charset to GBK\n                |\"\n                |\n                ".stripMargin()}),"Step 4: Click Ok in dialog","Step 5: Click button Run(it will take a while.)"],[n.createElement(zt,{source:'\n                | Step 0: We will treat url as label source, we use SQL to extract label from url:\n                |\n                |\n                |```\n                |-- http://sports.sohu.com/20070422/n249599819.shtml extract sports from url\n                |select temp.* from (select split(split(url,"/")[2],"\\\\.")[0] as labelStr,content from xmlData) as temp\n                |where temp.labelStr is not null\n                |as rawData;\n                |```\n                |\n                |For now , the label is string, we should convert them to number\n\n                '.stripMargin()}),n.createElement(zt,{source:"\n                |Step 1:  Drag Tools/Convert String to number, a dialog will open,\n                |\n                |```\n                |     1. set Input table as rawData,\n                |     2. Set save path as /tmp/nlp/label_mapping\n                |     3. Set inputCol as labelStr\n                |     4. Set outputCol as label\n                |     5. set Output table as rawDataWithLabel\n                |     6. set functionName table as rawDataWithLabel\n                |```\n                |We can use the functionName in SQL to convert String to number or number to String.\n                ".stripMargin()})],[n.createElement(zt,{source:"\n                |Step 0:  Drag Algorithms/TfIdf, a dialog will open,\n                |\n                |```\n                |         1. set Input table as rawDataWithLabel,\n                |         2. Set save path as /tmp/nlp/tfidf\n                |         3. Set inputCol as content\n                |         4. Set nGrams as 2\n                |         5. set Output table as trainData\n                |```\n                |Click Ok in dialog\n                ".stripMargin()}),n.createElement(zt,{source:"\n                |Step 1:  Drag [Register model as Function]/[Register Model As Function], a dialog will open,\n                |\n                |```\n                |         1. set Function name  as tfidf_predict,\n                |         2. Set Model saved path as /tmp/nlp/tfidf\n                |         3. Set et as TfIdfInPlace\n                |```\n                |Click Ok in dialog\n                ".stripMargin()}),"Step 2: Click button Run(it will take a while.)"],[n.createElement(zt,{source:"\n                |Step 0:  Drag Algorithms/RandomForest, a dialog will open,\n                |\n                |```\n                |         1. set tableName as trainData,\n                |         2. Set Model save path as /tmp/nlp/rf\n                |```\n                |Click Ok in dialog\n                ".stripMargin()}),n.createElement(zt,{source:"\n                |Step 1:  Drag [Register model as Function]/[Register Model As Function], a dialog will open,\n                |\n                |```\n                |         1. set Function name  as rf_predict,\n                |         2. Set Model saved path as /tmp/nlp/rf\n                |         3. Set et as RandomForest\n                |```\n                |Click Ok in dialog\n                ".stripMargin()}),"Step 2: Click button Run(it will take a while.)"],[n.createElement(zt,{source:'\n                |Paste:\n                |\n                |```sql\n                |select rf_predict(tfidf_predict("china is cool")) as predicted as output;\n                |```\n                '.stripMargin()}),"Step 2: Click button Run(it will take a while.)"]]}},{key:"generateCommandData",value:function(){return['run command as DownloadExt.`` where \n             |from="public/SogouCS.reduced.tar" and\n             |to="/tmp/nlp/sogo";'.stripMargin(),'load xml.`/tmp/nlp/sogo` where rowTag="doc" and charset="GBK" as xmlData; '.stripMargin(),'-- http://sports.sohu.com/20070422/n249599819.shtml extract sports from url\n            |select temp.* from (select split(split(url,"/")[2],"\\\\.")[0] as labelStr,content from xmlData) as temp \n            |where temp.labelStr is not null \n            |as rawData;\n            |-- select distinct(split(split(url,"/")[2],"\\\\.")[0]) as labelStr from rawData as output;\n            |-- select split(split(url,"/")[2],"\\\\.")[0] as labelStr,url from rawData as output;\n            |\n            |run rawData as StringIndex.`/tmp/nlp/label_mapping` where inputCol="labelStr"and\n            |outputCol="label" ;\n            |predict rawData as StringIndex.`/tmp/nlp/label_mapping` as rawDataWithLabel;\n            |register StringIndex.`/tmp/nlp/label_mapping` as convert_label; '.stripMargin(),'train rawDataWithLabel as TfIdfInPlace.`/tmp/nlp/tfidf` where inputCol="content"\n            |and nGrams="2" as trainData;\n            |\n            |register TfIdfInPlace.`/tmp/nlp/tfidf` as tfidf_predict;'.stripMargin(),'train trainData as RandomForest.`/tmp/nlp/rf` where \n            |keepVersion="true";\n            |\n            |register RandomForest.`/tmp/nlp/rf` as rf_predict;'.stripMargin(),'select rf_predict(tfidf_predict("china is cool")) as predicted as output;'.stripMargin()]}}]),t}(Gt),Wt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).renderView=function(){return a.state.currentView===kt?n.createElement(Gt,null):a.state.currentView===Ct?n.createElement(Jt,null):null},a.state={currentView:kt},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return this.renderView()}}]),t}(n.Component),Kt=Tt.a.Header,$t=Tt.a.Content,Yt=Tt.a.Footer,Zt=Tt.a.Sider,Xt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).switchToBigDL=function(){a.demosRef.current.setState({currentView:kt})},a.switchToNLP=function(){a.demosRef.current.setState({currentView:Ct})},a.demosRef=n.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return n.createElement(Tt.a,{style:{minHeight:"100vh"}},n.createElement(Zt,null,n.createElement("div",{className:"logo"}),n.createElement(Dt.a,{theme:"dark",defaultSelectedKeys:["1"],mode:"inline"},n.createElement(Dt.a.Item,{key:"1"},n.createElement(xt.a,{type:"desktop"}),n.createElement("span",null,n.createElement("a",{style:{color:"white"},onClick:this.switchToBigDL},"Cifar10"))),n.createElement(Dt.a.Item,{key:"2"},n.createElement(xt.a,{type:"desktop"}),n.createElement("span",null,n.createElement("a",{style:{color:"white"},onClick:this.switchToNLP},"NLP"))))),n.createElement(Tt.a,null,n.createElement(Kt,{style:{background:"#fff",padding:0}}),n.createElement($t,{style:{margin:"0 16px"}},n.createElement("div",{style:{padding:24,background:"#fff",minHeight:360}},n.createElement(Wt,{ref:this.demosRef}))),n.createElement(Yt,{style:{textAlign:"center"}})))}}]),t}(n.Component),ea=function(e){function t(e){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).call(this,e))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return n.createElement("div",null,n.createElement(Xt,null))}}]),t}(n.Component),ta="login",aa="register",na=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).getLoginOrRegisterManager=function(){return a.app.registerOrLoginRef.current},a.logout=function(){a.auth.logout(),a.app.updateLoginoutStatus()},a.login=function(){a.logout(),a.getLoginOrRegisterManager().setState({loginType:ta})},a.register=function(){a.logout(),a.getLoginOrRegisterManager().setState({loginType:aa})},a.updateLoginoutStatus=function(){a.setState({isLogin:a.auth.isLogin()})},a.auth=new V,a.state={isLogin:a.auth.isLogin()},a.app=a.props.parent,a.auth.userName(function(e){a.setState({userName:e})}),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=n.createElement(f.a,{className:"bp3-minimal",icon:"log-in",text:"Login",onClick:this.login}),t=n.createElement(f.a,{className:"bp3-minimal",icon:"log-out",text:"Logout",onClick:this.logout}),a=n.createElement(f.a,{className:"bp3-minimal",icon:"intersection",text:"Register",onClick:this.register});return n.createElement("div",null,this.state.isLogin?"welcome  "+this.state.userName:"",this.state.isLogin?t:e,a)}}]),t}(n.Component),ra=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).currentView=function(){return a.app.state.currentView},a.userName=function(e){a.setState({userName:e.target.value})},a.password=function(e){a.setState({password:e.target.value})},a.updateLoginoutStatus=function(){a.setState({isLogin:a.auth.isLogin()})},a.registerSuccess=function(e){if(e.status===y.Success)a.setState({registerOrLoginSuccess:!0}),a.app.updateLoginoutStatus();else{var t=Object(d.a)(Object(d.a)(a)),n=function(e){var a=e;try{a=JSON.parse(e).msg}catch(n){}t.setState({msg:a})};e.content.then(n).catch(n)}},a.registerFail=function(e){a.setState({msg:e.value.message})},a.login=function(){new oa(Object(d.a)(Object(d.a)(a))).validate()&&a.auth.login(a.state.userName,a.state.password,a.registerSuccess,a.registerFail)},a.register=function(){new oa(Object(d.a)(Object(d.a)(a))).validate()&&a.auth.register(a.state.userName,a.state.password,a.registerSuccess,a.registerFail)},a.auth=new V,a.app=a.props.parent,a.state={registerOrLoginSuccess:!1,msg:"",isLogin:a.auth.isLogin(),loginType:a.props.loginType||ta},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return this.state.isLogin&&this.currentView()===yt?n.createElement(Et,null):this.state.isLogin&&this.currentView()===vt?n.createElement(Ft,null):this.state.isLogin&&this.currentView()===St?n.createElement(ea,null):n.createElement("div",{className:"mlsql-register"},n.createElement("div",{className:"mlsql-register-form"},n.createElement(b.a,{helperText:"email",label:"userName",labelFor:"userName",labelInfo:"(required)"},n.createElement(E.a,{id:"userName",placeholder:"email",onChange:this.userName})),n.createElement(b.a,{helperText:"password",label:"password",labelFor:"password",labelInfo:"(required)"},n.createElement(E.a,{id:"password",type:"password",placeholder:"password",onChange:this.password})),n.createElement(f.a,{type:"submit",text:this.state.loginType===ta?"Login":"Register",onClick:this.state.loginType===ta?this.login:this.register}),""!==this.state.msg&&n.createElement("div",{className:"mlsql-register-messagebox"},this.state.msg)))}}]),t}(n.Component),oa=function(){function e(t){Object(i.a)(this,e),this.parent=t}return Object(c.a)(e,[{key:"validate",value:function(){return this.validateUserName()&&this.validatePassword()}},{key:"validateUserName",value:function(){var e=/[a-zA-Z0-9]+[\.]?([a-zA-Z0-9]+)?[\@][a-z]{3,9}[\.][a-z]{2,5}/g.test(this.parent.state.userName);return e||this.parent.setState({msg:"userName should be email"}),e}},{key:"validatePassword",value:function(){var e=this.parent.state.password.length>=4;return e||this.parent.setState({msg:"the length of password should > 4"}),e}}]),e}();a(730).inject();var la=function(e,t,a){g.a[e]({message:t,description:a})},ia=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).updateLoginoutStatus=function(){a.menuRef.current.updateLoginoutStatus(),a.registerOrLoginRef.current.updateLoginoutStatus()},a.switchToCluster=function(){var e=new V,t=Object(d.a)(Object(d.a)(a));e.user(function(e){console.log(e.role),"admin"==e.role?t.setState({currentView:vt}):la("error","Auth Fail","You are not allow to visit Cluster Manager")})},a.switchToConsole=function(){a.setState({currentView:yt})},a.switchToDemo=function(){a.setState({currentView:St})},a.switchToCnDoc=function(){window.open("http://docs.mlsql.tech/zh/","_blank")},a.menuRef=r.a.createRef(),a.registerOrLoginRef=r.a.createRef(),a.state={currentView:yt},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(p.a,null,r.a.createElement(p.a.Group,{align:h.a.LEFT},r.a.createElement(p.a.Heading,null,"MLSQL Web Console"),r.a.createElement(p.a.Divider,null),r.a.createElement(f.a,{className:"bp3-minimal",icon:"home",text:"Console",onClick:this.switchToConsole}),r.a.createElement(f.a,{className:"bp3-minimal",icon:"document",text:"Demo Center",onClick:this.switchToDemo}),r.a.createElement(f.a,{className:"bp3-minimal",icon:"document",text:"Cluster",onClick:this.switchToCluster}),r.a.createElement(f.a,{className:"bp3-minimal",icon:"document",text:"\u4e2d\u6587\u6587\u6863",onClick:this.switchToCnDoc})),r.a.createElement(p.a.Group,{align:h.a.RIGHT},r.a.createElement(na,{ref:this.menuRef,parent:this}))),r.a.createElement(ra,{ref:this.registerOrLoginRef,parent:this,loginType:ta}),r.a.createElement("div",{style:{bottom:"100px",textAlign:"center",width:"100%"}},"MLSQL Licensed under the Apache License, Version 2.0. @",r.a.createElement("a",{className:"copyright",href:"http://www.miitbeian.gov.cn/"},"\u6d59ICP\u590718052520\u53f7")))}}]),t}(n.Component);l.a.render(r.a.createElement(ia,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[349,2,1]]]);
//# sourceMappingURL=main.1de04bcf.chunk.js.map